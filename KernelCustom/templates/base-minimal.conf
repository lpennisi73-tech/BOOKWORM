#!/bin/bash
TEMPLATE_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"

CONFIG="$TEMPLATE_DIR/../sources/linux/scripts/config"

BLUE=$(tput setaf 6); GREEN=$(tput setaf 2); RED=$(tput setaf 1); BOLD=$(tput bold); RESET=$(tput sgr0)

echo "${BLUE}=== [Base-Minimal] Application du socle minimal ===${RESET}"
$CONFIG --disable CONFIG_SND && echo "  ${RED}- Audio désactivé${RESET}"
$CONFIG --disable CONFIG_USB_SUPPORT && echo "  ${RED}- USB désactivé${RESET}"
$CONFIG --disable CONFIG_BT && echo "  ${RED}- Bluetooth désactivé${RESET}"
$CONFIG --disable CONFIG_DRM && echo "  ${RED}- DRM/GPU désactivé${RESET}"
$CONFIG --enable CONFIG_NETFILTER && echo "  ${GREEN}+ Netfilter activé${RESET}"
$CONFIG --enable CONFIG_IPV6 && echo "  ${GREEN}+ IPv6 activé${RESET}"
$CONFIG --enable CONFIG_PM && echo "  ${GREEN}+ Gestion d'énergie activée${RESET}"
echo "✅ ${BOLD}${GREEN}[Base-Minimal] Terminé.${RESET}"
$CONFIG --set-str MODULE_SIG_KEY "certs/signing_key.pem"
$CONFIG --enable MODULE_SIG_KEY_TYPE_RSA
$CONFIG --enable SYSTEM_TRUSTED_KEYRING
$CONFIG --set-str SYSTEM_TRUSTED_KEYS ""
